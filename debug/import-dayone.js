/**
 * Created by Zizy on 17/09/2017.
 */


let dayOne ={
  "metadata" : {
    "version" : "1.0"
  },
  "entries" : [
    {
      "starred" : false,
      "location" : {
        "region" : {
          "center" : {
            "longitude" : 114.13553619384766,
            "latitude" : 22.28691291809082
          },
          "radius" : 75
        },
        "localityName" : "Hong Kong",
        "country" : "Hong Kong",
        "longitude" : 114.13553619384766,
        "administrativeArea" : "Hong Kong",
        "placeName" : "Hong Kong Plaza",
        "latitude" : 22.28691291809082
      },
      "sourceString" : "visit-A28C6D64-8662-4F90-8711-74A0600322EC",
      "userActivity" : {
        "activityName" : "Stationary"
      },
      "text" : "做游戏以及第二次喝茶邀约的一周\n\n![](dayone-moment:\/\/D67A059CA7F441429864B6E6F7502595)\n\n总得来说这周从焦虑到慢慢看淡一些虚无的东西。分手之后有一种恢复生活原本模样的感觉。\n前几天沉迷做游戏，对unity慢慢加深理解，似乎真的可以做出来一个什么东西。\n周四的时候开了第一次dissertation会议，有些很厉害的人出现，突然对于自己未来要做的事情有点恐惧。\n叔叔不约处于一个几乎要自己全职投入的状态。学习无法完全的兼顾，只能调低优先级。\n突然觉得应该彻底的把叔叔不约移出中国，但是依然没想好应该怎么做。也不知道所谓彻底到底应该多彻底。\n周五在复习data mining不是很爱这种只为了考试复习的感觉。",
      "weather" : {
        "temperatureCelsius" : 20,
        "weatherServiceName" : "Forecast.io",
        "windBearing" : 84,
        "sunriseDate" : "1970-01-01T00:00:00Z",
        "conditionsDescription" : "Clear",
        "pressureMB" : 1015.9600219726562,
        "visibilityKM" : 9,
        "relativeHumidity" : 90,
        "windSpeedKPH" : 18.329999923706055,
        "weatherCode" : "clear-night",
        "sunsetDate" : "1970-01-01T00:00:00Z"
      },
      "creationDate" : "2018-03-16T17:13:32Z",
      "timeZone" : "Asia\/Hong_Kong",
      "uuid" : "33F6158FF03F4109BA9D1ED7FB7337D6",
      "duration" : 0,
      "photos" : [
        {
          "fnumber" : "(null)",
          "orderInEntry" : 0,
          "width" : 2048,
          "type" : "jpeg",
          "identifier" : "D67A059CA7F441429864B6E6F7502595",
          "date" : "2018-03-16T17:13:32Z",
          "location" : {
            "region" : {
              "center" : {
                "longitude" : 114.13553619384766,
                "latitude" : 22.286912917361569
              },
              "identifier" : "<+22.28691292,+114.13553619> radius 70.92",
              "radius" : 70.916244306138481
            },
            "localityName" : "Hong Kong",
            "country" : "Hong Kong",
            "timeZoneName" : "Asia\/Hong_Kong",
            "administrativeArea" : "Hong Kong",
            "longitude" : 114.13553619384766,
            "placeName" : "Hong Kong Plaza",
            "latitude" : 22.28691291809082
          },
          "weather" : {
            "weatherServiceName" : "Forecast.io",
            "windBearing" : 84,
            "conditionsDescription" : "Clear",
            "pressureMB" : 1015.9600219726562,
            "visibilityKM" : 9,
            "relativeHumidity" : 90,
            "windSpeedKPH" : 18.329999923706055,
            "weatherCode" : "clear-night",
            "temperatureCelsius" : 20.850000381469727
          },
          "height" : 2048,
          "md5" : "676e45ac1df83e1134f9c5a83dc13d14",
          "focalLength" : "(null)"
        }
      ]
    },
    {
      "starred" : false,
      "location" : {
        "region" : {
          "center" : {
            "longitude" : 114.13798522949219,
            "latitude" : 22.285934448242188
          },
          "radius" : 75
        },
        "localityName" : "Hong Kong",
        "country" : "Hong Kong",
        "longitude" : 114.13798522949219,
        "administrativeArea" : "Hong Kong",
        "placeName" : "179 Third Street, Hong Kong",
        "latitude" : 22.285934448242188
      },
      "creationDate" : "2018-03-19T01:26:08Z",
      "userActivity" : {
        "activityName" : "Walking",
        "stepCount" : 2004
      },
      "text" : "复习DM沉迷Linux的一周\n\n![](dayone-moment:\/\/EE147ADB2C134FC2951A2650DA02AD03)\n\n周五没有存在感的放假，复习了一天的datamining，周六没做什么，周日是对网站的修修改改，新的架构，一切似乎看起来更有道理了一点。",
      "weather" : {
        "temperatureCelsius" : 22,
        "weatherServiceName" : "Forecast.io",
        "windBearing" : 86,
        "sunriseDate" : "1970-01-01T00:00:00Z",
        "conditionsDescription" : "Partly Cloudy",
        "pressureMB" : 1013.8200073242188,
        "visibilityKM" : 7,
        "relativeHumidity" : 87,
        "windSpeedKPH" : 13.779999732971191,
        "weatherCode" : "partly-cloudy",
        "sunsetDate" : "1970-01-01T00:00:00Z"
      },
      "timeZone" : "Asia\/Hong_Kong",
      "uuid" : "0FEC207FED1D48D6BBD97631BF7E9150",
      "duration" : 0,
      "photos" : [
        {
          "fnumber" : "(null)",
          "orderInEntry" : 0,
          "width" : 2048,
          "type" : "jpeg",
          "identifier" : "EE147ADB2C134FC2951A2650DA02AD03",
          "height" : 2048,
          "md5" : "e39008d88fd2d486bf9e33c7e5c68a96",
          "focalLength" : "(null)"
        }
      ]
    }
  ]};


let structured = dayOne.entries.map(i => {
  return {
    img_url: 'http://owdi2r4ca.bkt.clouddn.com/' + i.photos[0].md5 + '.jpeg?imageView2/2/w/400/h/400/interlace/1/q/100',
    title: i.text.substr(0, i.text.indexOf('![]')),
    content: i.text.substr(i.text.lastIndexOf(')\n\n') + 2, i.text.indexOf('////') != -1 ? i.text.indexOf('////') - i.text.lastIndexOf(')\n\n') - 2 : undefined),
    date: i.creationDate,
    id: i.uuid,
    place: i.location && i.location.placeName
  }
});
console.log(structured)
