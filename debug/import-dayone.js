/**
 * Created by Zizy on 17/09/2017.
 */


let dayOne ={
  "metadata" : {
    "version" : "1.0"
  },
  "entries" : [
    {
      "starred" : false,
      "location" : {
        "region" : {
          "center" : {
            "longitude" : 114.13749694824219,
            "latitude" : 22.285680770874023
          },
          "radius" : 75
        },
        "localityName" : "Hong Kong",
        "country" : "Hong Kong",
        "longitude" : 114.13749694824219,
        "administrativeArea" : "Hong Kong",
        "placeName" : "179 Third Street, Hong Kong",
        "latitude" : 22.285680770874023
      },
      "sourceString" : "visit-899AFD02-33D2-455D-B57D-E5C8C34AD9D7",
      "userActivity" : {
        "activityName" : "Stationary",
        "stepCount" : 1460
      },
      "text" : "写作业的一星期\n\n![](dayone-moment:\/\/80033743445644769658BDACD744D26B)\n\n心情3分。每天写作业到凌晨快要天亮。\n智华和dental，\nUCC咖啡和Coke Zero，\n夜宵和剧，\nmultimediaumlapp和security，\n黑眼圈，\n写出来作业的开心和写不出的悲伤。\n\/\/\/\/还有会弄乱我头发的奇怪小姐姐。\n和小姐姐好像慢慢趋于平静。\n好像变成了生活里很平常的一部分。",
      "weather" : {
        "sunsetDate" : "2017-12-06T09:40:13Z",
        "temperatureCelsius" : 19,
        "weatherServiceName" : "HAMweather",
        "windBearing" : 70,
        "sunriseDate" : "2017-12-05T22:50:32Z",
        "conditionsDescription" : "Mostly Clear",
        "pressureMB" : 1018,
        "visibilityKM" : 48.280319213867188,
        "relativeHumidity" : 64,
        "windSpeedKPH" : 11,
        "weatherCode" : "cloudy-night",
        "windChillCelsius" : 19
      },
      "creationDate" : "2017-12-05T17:31:46Z",
      "timeZone" : "Asia\/Hong_Kong",
      "uuid" : "5B581F647B2A44D3AB2D1775B482C88F",
      "duration" : 0,
      "photos" : [
        {
          "fnumber" : "(null)",
          "orderInEntry" : 0,
          "width" : 2048,
          "type" : "jpeg",
          "identifier" : "80033743445644769658BDACD744D26B",
          "height" : 2048,
          "md5" : "86b49a10daa21f55395fc9bfdd9c8167",
          "focalLength" : "(null)"
        }
      ]
    },
    {
      "starred" : false,
      "location" : {
        "region" : {
          "center" : {
            "longitude" : 114.13760375976562,
            "latitude" : 22.285758972167969
          },
          "radius" : 75
        },
        "localityName" : "Hong Kong",
        "country" : "Hong Kong",
        "longitude" : 114.13760375976562,
        "administrativeArea" : "Hong Kong",
        "placeName" : "208 Third Street, Hong Kong",
        "latitude" : 22.285758972167969
      },
      "sourceString" : "visit-D0095527-DCAC-4E43-8545-72D6707916CC",
      "userActivity" : {
        "activityName" : "Stationary"
      },
      "text" : "写报告的一天\n\n![](dayone-moment:\/\/69B41E04E9A245EDA52BF2E3CCF55FE5)\n\n心情2分。写不应该自己写的报告。就很烦啦。\n然后感觉别人家的组员就认真负责的写了很多更失落了！\n打卡了必胜客猪肋骨没有吃的很爽还是想继续吃肉啊！\n为什么在这个香港破地方想吃肉吃到爽那么难呢！！！",
      "weather" : {
        "sunsetDate" : "2017-12-07T09:40:26Z",
        "temperatureCelsius" : 19,
        "weatherServiceName" : "HAMweather",
        "windBearing" : 80,
        "sunriseDate" : "2017-12-06T22:51:11Z",
        "conditionsDescription" : "Mostly Clear",
        "pressureMB" : 1018,
        "visibilityKM" : 11.265407562255859,
        "relativeHumidity" : 68,
        "windSpeedKPH" : 15,
        "weatherCode" : "cloudy-night",
        "windChillCelsius" : 19
      },
      "creationDate" : "2017-12-06T16:30:16Z",
      "timeZone" : "Asia\/Hong_Kong",
      "uuid" : "441E102229E64F088387363BE6E843C0",
      "duration" : 0,
      "photos" : [
        {
          "fnumber" : "(null)",
          "orderInEntry" : 0,
          "width" : 2048,
          "type" : "jpeg",
          "identifier" : "69B41E04E9A245EDA52BF2E3CCF55FE5",
          "height" : 2048,
          "md5" : "32249402aecb9202d668439c36c959a9",
          "focalLength" : "(null)"
        }
      ]
    },
    {
      "starred" : false,
      "location" : {
        "region" : {
          "center" : {
            "longitude" : 114.13764953613281,
            "latitude" : 22.285415649414062
          },
          "radius" : 75
        },
        "localityName" : "Hong Kong",
        "country" : "Hong Kong",
        "longitude" : 114.13764953613281,
        "administrativeArea" : "Hong Kong",
        "placeName" : "69 Pok Fu Lam Road, Hong Kong",
        "latitude" : 22.285415649414062
      },
      "sourceString" : "visit-2D01F9E8-F3A6-481F-AAE8-742EC3DD7FCB",
      "userActivity" : {
        "activityName" : "Stationary",
        "stepCount" : 12
      },
      "text" : "失眠失眠失眠失眠\n\n![](dayone-moment:\/\/EECDC99105AE4780AEBB9606F834C7E4)\n\n心情2.5分。一天吃两顿煲仔饭也是没谁了。\n作业没写多少不开心不开心。\nswift好难，怎么能学那么多东西呢。\n总觉得自己在慢慢变得越来越avg。\n晚上越想越觉得，\n过的这一段时间仿佛都没有好好利用时间。",
      "weather" : {
        "sunsetDate" : "2017-12-08T09:40:39Z",
        "temperatureCelsius" : 19,
        "weatherServiceName" : "HAMweather",
        "windBearing" : 60,
        "sunriseDate" : "2017-12-07T22:51:49Z",
        "conditionsDescription" : "Mostly Clear",
        "pressureMB" : 1021,
        "visibilityKM" : 11.265407562255859,
        "relativeHumidity" : 52,
        "windSpeedKPH" : 17,
        "weatherCode" : "cloudy-night",
        "windChillCelsius" : 19
      },
      "creationDate" : "2017-12-07T18:11:09Z",
      "timeZone" : "Asia\/Hong_Kong",
      "uuid" : "853DCB2143514CAC812EE7FD850D36CA",
      "duration" : 0,
      "photos" : [
        {
          "fnumber" : "(null)",
          "orderInEntry" : 0,
          "width" : 2048,
          "type" : "jpeg",
          "identifier" : "EECDC99105AE4780AEBB9606F834C7E4",
          "height" : 2048,
          "md5" : "5637c0f5a0cfcbccf4ddc42819b7a07d",
          "focalLength" : "(null)"
        }
      ]
    },
    {
      "starred" : false,
      "location" : {
        "region" : {
          "center" : {
            "longitude" : 114.13772583007812,
            "latitude" : 22.285459518432617
          },
          "radius" : 75
        },
        "localityName" : "Hong Kong",
        "country" : "Hong Kong",
        "longitude" : 114.13772583007812,
        "administrativeArea" : "Hong Kong",
        "placeName" : "67 Pok Fu Lam Road, Hong Kong",
        "latitude" : 22.285459518432617
      },
      "sourceString" : "visit-7A5C1A57-3E0E-4DBE-BE82-BCCF1A45ABD3",
      "userActivity" : {
        "activityName" : "Stationary"
      },
      "text" : "复习倒数第二天\n\n![](dayone-moment:\/\/8954BD2A14EF4CF0BE1DF6D96726D79B)\n\n心情3分。第一次考试需要用那么久来复习啊。\n明明看了很久的书还是没复习完多少的感觉。\n有一种很想逃避所有人的感觉。\n开始考前低潮期。",
      "weather" : {
        "sunsetDate" : "2017-12-10T09:41:11Z",
        "temperatureCelsius" : 17,
        "weatherServiceName" : "HAMweather",
        "windBearing" : 70,
        "sunriseDate" : "2017-12-09T22:53:05Z",
        "conditionsDescription" : "Mostly Clear",
        "pressureMB" : 1018,
        "visibilityKM" : 8,
        "relativeHumidity" : 56,
        "windSpeedKPH" : 7,
        "weatherCode" : "cloudy-night",
        "windChillCelsius" : 17
      },
      "creationDate" : "2017-12-08T17:21:21Z",
      "timeZone" : "Asia\/Hong_Kong",
      "uuid" : "85296C136CE14670A162B024E1F657E7",
      "duration" : 0,
      "photos" : [
        {
          "fnumber" : "(null)",
          "orderInEntry" : 0,
          "width" : 2048,
          "type" : "jpeg",
          "identifier" : "8954BD2A14EF4CF0BE1DF6D96726D79B",
          "height" : 2048,
          "md5" : "84cc0a4f8a57fbfca2d6d427fa1f05bf",
          "focalLength" : "(null)"
        }
      ]
    }
  ]};


let structured = dayOne.entries.map(i => {
  return {
    img_url: 'http://owdi2r4ca.bkt.clouddn.com/' + i.photos[0].md5 + '.jpeg?imageView2/2/w/400/h/400/interlace/1/q/100',
    title: i.text.substr(0, i.text.indexOf('![]')),
    content: i.text.substr(i.text.lastIndexOf(')\n\n') + 2, i.text.indexOf('////') != -1 ? i.text.indexOf('////') - i.text.lastIndexOf(')\n\n') - 2 : undefined),
    date: i.creationDate,
    id: i.uuid,
    place: i.location && i.location.placeName
  }
});
console.log(structured)
