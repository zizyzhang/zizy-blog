/**
 * Created by Zizy on 17/09/2017.
 */


let dayOne ={
  "metadata" : {
    "version" : "1.0"
  },
  "entries" : [
    {
      "starred" : false,
      "location" : {
        "region" : {
          "center" : {
            "longitude" : 121.11163330078125,
            "latitude" : 28.845869064331055
          },
          "radius" : 75
        },
        "localityName" : "Taizhou",
        "country" : "China",
        "longitude" : 121.11163330078125,
        "administrativeArea" : "Zhejiang",
        "placeName" : "Ziyang Old Street",
        "latitude" : 28.845869064331055
      },
      "sourceString" : "visit-60FAD725-2143-42B6-B722-F26E4A2292A0",
      "userActivity" : {
        "activityName" : "Stationary",
        "stepCount" : 619
      },
      "text" : "咖啡厅学习DL，吃吃喝喝的三天\n\n![](dayone-moment:\/\/591EC25BC8FE45918CEDA3133987A5B7)\n\n心情3分。最近三天沉迷咖啡厅。\n买了居多有的没的，袜子电动牙刷，新的通勤用耳机。\n网站推广计划有略微的进展。牙刷好评！\nQC30感觉不如35。\nDL终于做完了最后一个作业！\n虽然不知道为什么结果对但是过程错了。",
      "weather" : {
        "sunsetDate" : "2018-01-11T09:13:18Z",
        "temperatureCelsius" : 6,
        "weatherServiceName" : "HAMweather",
        "windBearing" : 330,
        "sunriseDate" : "2018-01-10T22:50:38Z",
        "conditionsDescription" : "Mostly Sunny",
        "pressureMB" : 1032,
        "visibilityKM" : 11.265407562255859,
        "relativeHumidity" : 29,
        "windSpeedKPH" : 18,
        "weatherCode" : "partly-cloudy",
        "windChillCelsius" : 3
      },
      "creationDate" : "2018-01-11T07:32:57Z",
      "timeZone" : "Asia\/Shanghai",
      "uuid" : "78787B6C858548D68B69A8AD8B92AF8C",
      "duration" : 0,
      "photos" : [
        {
          "fnumber" : "(null)",
          "orderInEntry" : 0,
          "width" : 2048,
          "type" : "jpeg",
          "identifier" : "591EC25BC8FE45918CEDA3133987A5B7",
          "date" : "2018-01-13T07:32:57Z",
          "location" : {
            "region" : {
              "center" : {
                "longitude" : 121.11405049999999,
                "latitude" : 28.843445500000001
              },
              "identifier" : "<+28.84344550,+121.11405050> radius 647.09",
              "radius" : 647.08799868582901
            },
            "localityName" : "Taizhou",
            "country" : "China",
            "timeZoneName" : "Asia\/Shanghai",
            "administrativeArea" : "Zhejiang",
            "longitude" : 121.11163330078125,
            "placeName" : "Ziyang Old Street",
            "latitude" : 28.845869064331055
          },
          "weather" : {
            "sunsetDate" : "2018-01-13T09:14:57Z",
            "temperatureCelsius" : 7,
            "weatherServiceName" : "HAMweather",
            "windBearing" : 0,
            "sunriseDate" : "2018-01-12T22:50:32Z",
            "conditionsDescription" : "Mostly Sunny",
            "pressureMB" : 1033,
            "visibilityKM" : 11.265407562255859,
            "relativeHumidity" : 19,
            "windSpeedKPH" : 4,
            "weatherCode" : "partly-cloudy",
            "windChillCelsius" : 7
          },
          "height" : 2048,
          "md5" : "393f21e3eacf34861b3b10b0a8555836",
          "focalLength" : "(null)"
        }
      ]
    },
    {
      "starred" : false,
      "location" : {
        "region" : {
          "center" : {
            "longitude" : 121.13843536376953,
            "latitude" : 28.847883224487305
          },
          "radius" : 75
        },
        "localityName" : "Taizhou",
        "country" : "China",
        "longitude" : 121.13843536376953,
        "administrativeArea" : "Zhejiang",
        "placeName" : "Baiyun 1st Alley",
        "latitude" : 28.847883224487305
      },
      "sourceString" : "visit-5C649304-6BC2-4258-A20D-1065D8B0C770",
      "userActivity" : {
        "activityName" : "Stationary",
        "stepCount" : 508
      },
      "text" : "高中小聚看了电影前任的一天\n\n![](dayone-moment:\/\/78084DF275084F2E94DA8215563C98D5)\n\n心情3.5分。放假的最后一次聚会，还是开心的。\n看了前任三觉得还是很有代入感，比起电影感觉还是影评比较感人。\n最近的几年里总觉得自己的三观总在经历着天翻地覆，自己都来不及去适应接受所有的改变，让另一个人也需要和你保持同步也许真的是不太可能的事情。",
      "weather" : {
        "sunsetDate" : "2018-01-12T09:14:08Z",
        "temperatureCelsius" : 4,
        "weatherServiceName" : "HAMweather",
        "windBearing" : 360,
        "sunriseDate" : "2018-01-11T22:50:36Z",
        "conditionsDescription" : "Mostly Sunny",
        "pressureMB" : 1035,
        "visibilityKM" : 11.265407562255859,
        "relativeHumidity" : 26,
        "windSpeedKPH" : 14,
        "weatherCode" : "partly-cloudy",
        "windChillCelsius" : 1
      },
      "creationDate" : "2018-01-12T07:38:13Z",
      "timeZone" : "Asia\/Shanghai",
      "uuid" : "31C6A90F18F04ACDB9419F8F435D4831",
      "duration" : 0,
      "photos" : [
        {
          "fnumber" : "(null)",
          "orderInEntry" : 0,
          "width" : 2048,
          "type" : "jpeg",
          "identifier" : "78084DF275084F2E94DA8215563C98D5",
          "date" : "2018-01-13T07:38:13Z",
          "location" : {
            "region" : {
              "center" : {
                "longitude" : 121.139268,
                "latitude" : 28.84639
              },
              "identifier" : "<+28.84639000,+121.13926800> radius 217.46",
              "radius" : 217.45815455950316
            },
            "localityName" : "Taizhou",
            "country" : "China",
            "timeZoneName" : "Asia\/Shanghai",
            "administrativeArea" : "Zhejiang",
            "longitude" : 121.13843536376953,
            "placeName" : "Baiyun 1st Alley",
            "latitude" : 28.847883224487305
          },
          "weather" : {
            "sunsetDate" : "2018-01-13T09:14:57Z",
            "temperatureCelsius" : 7,
            "weatherServiceName" : "HAMweather",
            "windBearing" : 0,
            "sunriseDate" : "2018-01-12T22:50:32Z",
            "conditionsDescription" : "Mostly Sunny",
            "pressureMB" : 1033,
            "visibilityKM" : 11.265407562255859,
            "relativeHumidity" : 19,
            "windSpeedKPH" : 4,
            "weatherCode" : "partly-cloudy",
            "windChillCelsius" : 7
          },
          "height" : 2048,
          "md5" : "a4b5b76f1494fd621a581e863d09fff8",
          "focalLength" : "(null)"
        }
      ]
    },
    {
      "starred" : false,
      "location" : {
        "region" : {
          "center" : {
            "longitude" : 114.11296081542969,
            "latitude" : 22.545436859130859
          },
          "radius" : 75
        },
        "localityName" : "Shenzhen",
        "country" : "China",
        "longitude" : 114.11296081542969,
        "administrativeArea" : "Guangdong",
        "placeName" : "Guiyuan Road",
        "latitude" : 22.545436859130859
      },
      "sourceString" : "visit-E5A2BA88-D0DC-4EBD-A8EB-09CA692260E0",
      "userActivity" : {
        "activityName" : "Stationary",
        "stepCount" : 1734
      },
      "text" : "去宁波赶飞机的一天\n\n![](dayone-moment:\/\/E4E9D0554C3243289FA492FC9C7B2A2E)\n\n心情3分。",
      "creationDate" : "2018-01-13T08:11:24Z",
      "timeZone" : "Asia\/Shanghai",
      "uuid" : "4107F6E843C049229310EF19068CBAEA",
      "duration" : 0,
      "photos" : [
        {
          "fnumber" : "(null)",
          "orderInEntry" : 0,
          "width" : 2048,
          "type" : "jpeg",
          "identifier" : "E4E9D0554C3243289FA492FC9C7B2A2E",
          "date" : "2018-01-18T08:11:24Z",
          "height" : 2048,
          "md5" : "dea68687f84e040ace1fdf42cfacdc1f",
          "focalLength" : "(null)"
        }
      ]
    },
    {
      "starred" : false,
      "location" : {
        "region" : {
          "center" : {
            "longitude" : 114.11294555664062,
            "latitude" : 22.545434951782227
          },
          "radius" : 75
        },
        "localityName" : "Shenzhen",
        "country" : "China",
        "longitude" : 114.11294555664062,
        "administrativeArea" : "Guangdong",
        "placeName" : "Guiyuan Road",
        "latitude" : 22.545434951782227
      },
      "sourceString" : "visit-17A78F55-1F9F-4B9A-8434-F7FD88844091",
      "userActivity" : {
        "activityName" : "Stationary",
        "stepCount" : 5031
      },
      "text" : "三个多小时飞机飞回学校的一天\n\n![](dayone-moment:\/\/7C80940D9C644B26A1C429F9FB00698E)\n\n心情3.5分",
      "weather" : {
        "sunsetDate" : "2018-01-14T10:00:31Z",
        "temperatureCelsius" : 18,
        "weatherServiceName" : "HAMweather",
        "windBearing" : 260,
        "sunriseDate" : "2018-01-13T23:06:07Z",
        "conditionsDescription" : "Mostly Sunny",
        "pressureMB" : 1019,
        "visibilityKM" : 11.265407562255859,
        "relativeHumidity" : 78,
        "windSpeedKPH" : 11,
        "weatherCode" : "partly-cloudy",
        "windChillCelsius" : 18
      },
      "creationDate" : "2018-01-14T08:12:31Z",
      "timeZone" : "Asia\/Shanghai",
      "uuid" : "BB0DF48635E9478F9EF63FBC1CAFFE9E",
      "duration" : 0,
      "photos" : [
        {
          "fnumber" : "(null)",
          "orderInEntry" : 0,
          "width" : 2048,
          "type" : "jpeg",
          "identifier" : "7C80940D9C644B26A1C429F9FB00698E",
          "height" : 2048,
          "md5" : "db91a9c040e039408703d9916a4a8c47",
          "focalLength" : "(null)"
        }
      ]
    },
    {
      "starred" : false,
      "location" : {
        "region" : {
          "center" : {
            "longitude" : 114.13536071777344,
            "latitude" : 22.283184051513672
          },
          "radius" : 75
        },
        "localityName" : "Hong Kong",
        "country" : "Hong Kong",
        "longitude" : 114.13536071777344,
        "administrativeArea" : "Hong Kong",
        "placeName" : "The University of Hong Kong",
        "latitude" : 22.283184051513672
      },
      "sourceString" : "visit-49B0A6C8-01BA-4DC4-B7D8-3EEEF7DBCDF5",
      "userActivity" : {
        "activityName" : "Stationary"
      },
      "text" : "早起上课下午睡觉晚上聚餐的一天\n\n![](dayone-moment:\/\/A9ED7B76BC164E3D946D3A03C367D014)\n\n心情3分。回到学校的第一次聚餐。\n早起赶回学校上课，ai的课比想象中的偏理论。\n晚上聚餐吃韩料，总觉得还没有那天深圳路边餐厅的正宗一些……\n说不上是开心还是不开心。好像一切回到了正常的轨迹，又似乎哪里有什么不对。说不清…",
      "weather" : {
        "temperatureCelsius" : 18,
        "weatherServiceName" : "Forecast.io",
        "windBearing" : 89,
        "sunriseDate" : "1970-01-01T00:00:00Z",
        "conditionsDescription" : "Partly Cloudy",
        "pressureMB" : 1017.0399780273438,
        "visibilityKM" : 10.010000228881836,
        "relativeHumidity" : 89,
        "windSpeedKPH" : 14.979999542236328,
        "weatherCode" : "cloudy-night",
        "sunsetDate" : "1970-01-01T00:00:00Z"
      },
      "creationDate" : "2018-01-19T16:24:02Z",
      "timeZone" : "Asia\/Hong_Kong",
      "uuid" : "744DAD246447416D8C34083376BCAE4F",
      "duration" : 0,
      "photos" : [
        {
          "fnumber" : "(null)",
          "orderInEntry" : 0,
          "width" : 2048,
          "type" : "jpeg",
          "identifier" : "A9ED7B76BC164E3D946D3A03C367D014",
          "date" : "2018-01-20T16:24:02Z",
          "location" : {
            "region" : {
              "center" : {
                "longitude" : 114.13536071777344,
                "latitude" : 22.283184048597214
              },
              "identifier" : "<+22.28318405,+114.13536072> radius 141.83",
              "radius" : 141.83262274255571
            },
            "localityName" : "Hong Kong",
            "country" : "Hong Kong",
            "timeZoneName" : "Asia\/Hong_Kong",
            "administrativeArea" : "Hong Kong",
            "longitude" : 114.13536071777344,
            "placeName" : "The University of Hong Kong",
            "latitude" : 22.283184051513672
          },
          "weather" : {
            "weatherServiceName" : "Forecast.io",
            "windBearing" : 81,
            "conditionsDescription" : "Partly Cloudy",
            "pressureMB" : 1016.0499877929688,
            "visibilityKM" : 8,
            "relativeHumidity" : 92,
            "windSpeedKPH" : 16.909999847412109,
            "weatherCode" : "cloudy-night",
            "temperatureCelsius" : 17.379999160766602
          },
          "height" : 2048,
          "md5" : "1ba46e963224a6135e46e020f8ebc97c",
          "focalLength" : "(null)"
        }
      ]
    }
  ]};


let structured = dayOne.entries.map(i => {
  return {
    img_url: 'http://owdi2r4ca.bkt.clouddn.com/' + i.photos[0].md5 + '.jpeg?imageView2/2/w/400/h/400/interlace/1/q/100',
    title: i.text.substr(0, i.text.indexOf('![]')),
    content: i.text.substr(i.text.lastIndexOf(')\n\n') + 2, i.text.indexOf('////') != -1 ? i.text.indexOf('////') - i.text.lastIndexOf(')\n\n') - 2 : undefined),
    date: i.creationDate,
    id: i.uuid,
    place: i.location && i.location.placeName
  }
});
console.log(structured)
